<% var isProjectIndex = (page.source === "projects/index.md") %>
<% var isNotProjectIndex = !isProjectIndex %>

<% if (isProjectIndex) { %>
<style rel="style" type="text/css">
  ul.project-list {
    margin: 0px auto;
    text-align: center;
    display: flex;
    flex-direction: row;
    flex-wrap: wrap;
    align-items: center;
    justify-content: center;
  }

  li.project-card {
    color: #eeeeee;
    margin: 10px;
    padding: 5px 25px;
    display: block;
    max-height: 40+0px;
    min-width: 150px;
    background: transparent;
    border: 2px dotted #f1f1f180;
    border-radius: 5px 5px 5px 5px;
    transition:
      color 0.6s ease,
      margin 0.6s ease,
      padding 0.6s ease,
      background 0.6s ease,
      border 0.6s ease,
      border-radius 0.6s ease;
  }

  li.project:hover,
  li.project:focus,
  li.project:active {
    color: #212121;
    padding: 5px 25px;
    background: #2bbc8a;
    border: 1px solid #2bbc8a;
    border-radius: 10px 5px 15px 5px;
  }

  .project-title {
    max-width: 250px;
    margin: 5px auto;
    text-align: center;
    color: #2bbc8a;
    font-size: 1.2em;
    transition:
      color 0.6s ease;
  }

  li.project:hover .project-title,
  li.project:focus .project-title,
  li.project:active .project-title {
    color: #eeeeee;
  }

  .project-title a.headerlink,
  .project-title:hover a.headerlink,
  .project-title a.headerlink:hover {
    cursor: pointer;
  }

  .project-title:hover a.headerlink,
  .project-title a.headerlink:hover {
    text-decoration: underline;
  }

  img.project-thumbnail {
    max-height: 200px;
    max-width: 200px;
    min-height: 150px;
    min-width: 150px;
    transition:
      max-width 1s ease,
      max-height 1s ease;
  }

  img.project-thumbnail:hover {
    max-height: 300px;
    max-width: 300px;
  }

  img.project-thumbnail,
  .project-subtitle,
  .project-desc {
    text-align: center;
    display: block;
    margin: 0px auto;
  }

  .project-subtitle a {
    margin: 10px;
    padding: 7px;
    color: #212121;
    background: #ddd;
    border: 1px solid #ddd;
    border-radius: 2px;
  }

  .project-subtitle:hover a,
  .project-subtitle:active a,
  .project-subtitle:focus a {
    background: transparent;
    color: #ddd;
  }

  .project-desc {
    margin: 5px auto;
    padding-top: 10px;
    max-width: 200px;
  }

  .heading {
    text-align: center;
  }
</style>
<% } %>

<% if (isNotProjectIndex) { %>
  <h1><a href="<%- url_for("projects") %>"><%= __('index.projects') %></a></h1>
<% } else { %>
  <h1 class="heading"><a href="#projects" class="headerlink"><%= __('index.projects') %></a></h1>
<% } %>

<% var sorted_by = theme.posts_overview.sort_updated ? 'updated' : 'date' %>
<% var sorted_posts = site.posts.sort(sorted_by, 'desc') %>
<% var sorted_projects = sorted_posts.filter((post) => post.project !== undefined) %>
<% var project_count = sorted_projects.length %>

<div class="project-list-title">
  <%- _p('counter.projects', project_count) %>
</div>

<% if (project_count > 0) { %>
  <ul class="project-list">
    <% for (var id = 0; id < sorted_projects.length; id++) { %>
      <% var post = sorted_projects.data[id] %>
      <% var project = post.project %>
      <% var item = {
        id,
        url: project.url,
        date: post.date,
        permalink: url_for(post.path),
        name: post.title,
        title: project.title,
        description: project.description ?? project.desc ?? `A project I worked on.`,
        prompt: project.prompt ?? 'Project Homepage',
        img: project.img
      } %>
      <% if (isNotProjectIndex) { %>
        <%- partial('_partial/project/line', { item }) %>
      <% } else { %>
        <%- partial('_partial/project/item', { item }) %>
      <% } %>
  <% } %>
  </ul>
<% } %>